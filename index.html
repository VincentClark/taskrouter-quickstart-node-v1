<!DOCTYPE html>
<html>
  <head>
    <title>Agents</title>
    <link
      rel="stylesheet"
      href="//media.twiliocdn.com/taskrouter/quickstart/agent.css"
    />
    <script
      src="https://sdk.twilio.com/js/taskrouter/v1.21/taskrouter.min.js"
      integrity="sha384-5fq+0qjayReAreRyHy38VpD3Gr9R2OYIzonwIkoGI4M9dhfKW6RWeRnZjfwSrpN8"
      crossorigin="anonymous"
    ></script>
    <script>
      console.log("enter");
      // Subscribe to a subset of the available TaskRouter.js events for a worker sync
      function registerTaskRouterCallbacks() {
        worker.on("ready", function (worker) {
          agentActivityChanged(worker.activityName);
          logger("Succesffuly resgistered as: " + worker.friendlyName);
          logger("Currently active activity: " + worker.activityName);
        });

        worker.on("activity.update", function (worker) {
          agentActivityChanged(worker.activityName);
          logger("Worker activity changed to: " + worker.activityName);
        });

        worker.on("reservation.created", function (reservation) {
          logger("------");
          logger("You have been reserved to handle a call");
          logger("Call from: " + reservation.task.attributes.from);
          logger(
            "Selected language:" + reservation.task.attributes.selected_language
          );
          logger("------");
        });

        worker.on("reservation.accepted", function (reservation) {
          logger("Reservation " + reservation.sid + " accepted");
        });

        worker.on("reservation.rejected", function (reservation) {
          logger("Reservation " + reservation.sid + " rejected");
        });

        worker.on("reservation.timeout", function (reservation) {
          logger("Reservation " + reservation.sid + " timed out");
        });
        worker.on("reservation.canceled", function (reservation) {
          logger(`Reservation ${reservation.sid} ${canceled}`);
        });
      }
      // Hook up the agent Activity buttons to TaskRouter.js
      function bindAgentActivityButtons() {
        // Fetch the full list of available Activities from TaskRouter. Store each
        // ActivitySid against the matching Friendly Name
        var activitySids = {};
        worker.activities.fetch(function (error, activityList) {
          var activities = activityList.data;
          var i = activities.length;
          while (i--) {
            activitySids[activities[i].friendlyName] = activities[i].sid;
          }
        });

        var elements = document.getElementsByClassName("change-activity");
        var i = elements.length;
        while (i--) {
          elements[i].onclick = function () {
            var nextActivity = this.dataset.nextActivity;
            var nextActivitySid = activitySids[nextActivity];
            worker.update({ ActivitySid: nextActivitySid });
          };
        }
      }

      // Update the UI to reflect a change in Activity

      function agentActivityChanged(activity) {
        hideAgentActivities();
        showAgentActivity(activity);
      }

      function hideAgentActivities() {
        var elements = document.getElementsByClassName("agent-activity");
        var i = elements.length;
        while (i--) {
          elements[i].style.display = "none";
        }
      }

      function showAgentActivity(activity) {
        activity = activity.toLowerCase();
        var elements = document.getElementsByClassName(
          "agent-activity " + activity
        );
        elements.item(0).style.display = "block";
      }

      /* Other stuff */

      function logger(message) {
        var log = document.getElementById("log");
        log.value += "\n> " + message;
        log.scrollTop = log.scrollHeight;
      }

      window.onload = function () {
        console.log("onLoad");
        // Initialize TaskRouter.js on page load using window.workerToken -
        // a Twilio Capability token that was set from rendering the template with agents endpoint
        logger("Initializing...");
        window.worker = new Twilio.TaskRouter.Worker(
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJBQzJjYzU5YTU3OTU0NzcyOTRkMzBiZTViNDJlMWI1OTMxIiwiZXhwIjoxNjM3Nzk3NjQyLCJ2ZXJzaW9uIjoidjEiLCJhY2NvdW50X3NpZCI6IkFDMmNjNTlhNTc5NTQ3NzI5NGQzMGJlNWI0MmUxYjU5MzEiLCJjaGFubmVsIjoiV0tkZTJjMjgxNDc1NDU1OWU2MzVlNDk0NmJhY2ZlOTg0MiIsIndvcmtzcGFjZV9zaWQiOiJXUzJhMDEwYmE2Mzg5YmVjMTg0OGE4ZWFkMzdjMDViZmFmIiwicG9saWNpZXMiOlt7InVybCI6Imh0dHBzOi8vZXZlbnQtYnJpZGdlLnR3aWxpby5jb20vdjEvd3NjaGFubmVscy9BQzJjYzU5YTU3OTU0NzcyOTRkMzBiZTViNDJlMWI1OTMxL1dLZGUyYzI4MTQ3NTQ1NTllNjM1ZTQ5NDZiYWNmZTk4NDIiLCJtZXRob2QiOiJHRVQiLCJxdWVyeV9maWx0ZXIiOnt9LCJwb3N0X2ZpbHRlciI6e30sImFsbG93Ijp0cnVlfSx7InVybCI6Imh0dHBzOi8vZXZlbnQtYnJpZGdlLnR3aWxpby5jb20vdjEvd3NjaGFubmVscy9BQzJjYzU5YTU3OTU0NzcyOTRkMzBiZTViNDJlMWI1OTMxL1dLZGUyYzI4MTQ3NTQ1NTllNjM1ZTQ5NDZiYWNmZTk4NDIiLCJtZXRob2QiOiJQT1NUIiwicXVlcnlfZmlsdGVyIjp7fSwicG9zdF9maWx0ZXIiOnt9LCJhbGxvdyI6dHJ1ZX0seyJ1cmwiOiJodHRwczovL3Rhc2tyb3V0ZXIudHdpbGlvLmNvbS92MS9Xb3Jrc3BhY2VzL1dTMmEwMTBiYTYzODliZWMxODQ4YThlYWQzN2MwNWJmYWYvQWN0aXZpdGllcyIsIm1ldGhvZCI6IkdFVCIsInF1ZXJ5X2ZpbHRlciI6e30sInBvc3RfZmlsdGVyIjp7fSwiYWxsb3ciOnRydWV9LHsidXJsIjoiaHR0cHM6Ly90YXNrcm91dGVyLnR3aWxpby5jb20vdjEvV29ya3NwYWNlcy9XUzJhMDEwYmE2Mzg5YmVjMTg0OGE4ZWFkMzdjMDViZmFmL1Rhc2tzLyoqIiwibWV0aG9kIjoiR0VUIiwicXVlcnlfZmlsdGVyIjp7fSwicG9zdF9maWx0ZXIiOnt9LCJhbGxvdyI6dHJ1ZX0seyJ1cmwiOiJodHRwczovL3Rhc2tyb3V0ZXIudHdpbGlvLmNvbS92MS9Xb3Jrc3BhY2VzL1dTMmEwMTBiYTYzODliZWMxODQ4YThlYWQzN2MwNWJmYWYvV29ya2Vycy9XS2RlMmMyODE0NzU0NTU5ZTYzNWU0OTQ2YmFjZmU5ODQyL1Jlc2VydmF0aW9ucy8qKiIsIm1ldGhvZCI6IkdFVCIsInF1ZXJ5X2ZpbHRlciI6e30sInBvc3RfZmlsdGVyIjp7fSwiYWxsb3ciOnRydWV9LHsidXJsIjoiaHR0cHM6Ly90YXNrcm91dGVyLnR3aWxpby5jb20vdjEvV29ya3NwYWNlcy9XUzJhMDEwYmE2Mzg5YmVjMTg0OGE4ZWFkMzdjMDViZmFmL1dvcmtlcnMvV0tkZTJjMjgxNDc1NDU1OWU2MzVlNDk0NmJhY2ZlOTg0MiIsIm1ldGhvZCI6IkdFVCIsInF1ZXJ5X2ZpbHRlciI6e30sInBvc3RfZmlsdGVyIjp7fSwiYWxsb3ciOnRydWV9LHsidXJsIjoiaHR0cHM6Ly90YXNrcm91dGVyLnR3aWxpby5jb20vdjEvV29ya3NwYWNlcy9XUzJhMDEwYmE2Mzg5YmVjMTg0OGE4ZWFkMzdjMDViZmFmIiwibWV0aG9kIjoiR0VUIiwicXVlcnlfZmlsdGVyIjp7fSwicG9zdF9maWx0ZXIiOnt9LCJhbGxvdyI6dHJ1ZX0seyJ1cmwiOiJodHRwczovL3Rhc2tyb3V0ZXIudHdpbGlvLmNvbS92MS9Xb3Jrc3BhY2VzL1dTMmEwMTBiYTYzODliZWMxODQ4YThlYWQzN2MwNWJmYWYvKioiLCJtZXRob2QiOiJHRVQiLCJxdWVyeV9maWx0ZXIiOnt9LCJwb3N0X2ZpbHRlciI6e30sImFsbG93Ijp0cnVlfSx7InVybCI6Imh0dHBzOi8vdGFza3JvdXRlci50d2lsaW8uY29tL3YxL1dvcmtzcGFjZXMvV1MyYTAxMGJhNjM4OWJlYzE4NDhhOGVhZDM3YzA1YmZhZi8qKiIsIm1ldGhvZCI6IlBPU1QiLCJxdWVyeV9maWx0ZXIiOnt9LCJwb3N0X2ZpbHRlciI6e30sImFsbG93Ijp0cnVlfSx7InVybCI6Imh0dHBzOi8vdGFza3JvdXRlci50d2lsaW8uY29tL3YxL1dvcmtzcGFjZXMvV1MyYTAxMGJhNjM4OWJlYzE4NDhhOGVhZDM3YzA1YmZhZi8qKiIsIm1ldGhvZCI6IkRFTEVURSIsInF1ZXJ5X2ZpbHRlciI6e30sInBvc3RfZmlsdGVyIjp7fSwiYWxsb3ciOnRydWV9XSwid29ya2VyX3NpZCI6IldLZGUyYzI4MTQ3NTQ1NTllNjM1ZTQ5NDZiYWNmZTk4NDIiLCJpYXQiOjE2Mzc3OTQwNDJ9.Mksz0JYZ8SJmWG9JC5juKLr0k4sxNG6bum5B5N-XURI"
        );

        registerTaskRouterCallbacks();
        bindAgentActivityButtons();
      };
    </script>
  </head>
  <body>
    <div class="content">
      <section class="agent-activity offline">
        <p class="activity"><span>Offline</span></p>
        <button class="change-activity" data-next-activity="Idle">
          <Go>Available</Go>
        </button>
      </section>
      <section class="agent-activity idle">
        <p class="activity"><span>Available</span></p>
        <button class="change-activity" data-next-activity="Offline">
          <Go>Offline</Go>
        </button>
      </section>
      <section class="agent-activity reserved">
        <p class="activity"><Reserved></Reserved></p>
      </section>
      <section class="agent-activity busy">
        <p class="activity"><Busy></Busy></p>
      </section>
      <section class="agent-activity wrapup">
        <p class="activity">
          <Wrap-Up></Wrap-Up
          ><button class="change-activity" data-next-activity="Idle">
            <Go>Available</Go></button
          ><button class="change-activity" data-next-activity="Offline">
            <Go>Offline</Go>
          </button>
        </p>
      </section>
      <section class="log">
        <textarea id="log" readonly="true"></textarea>
      </section>
    </div>
  </body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <title>Agents</title>
    <link
      rel="stylesheet"
      href="//media.twiliocdn.com/taskrouter/quickstart/agent.css"
    />
    <script
      src="https://sdk.twilio.com/js/taskrouter/v1.21/taskrouter.min.js"
      integrity="sha384-5fq+0qjayReAreRyHy38VpD3Gr9R2OYIzonwIkoGI4M9dhfKW6RWeRnZjfwSrpN8"
      crossorigin="anonymous"
    ></script>
    <script>
      console.log("enter");
      // Subscribe to a subset of the available TaskRouter.js events for a worker sync
      function registerTaskRouterCallbacks() {
        worker.on("ready", function (worker) {
          agentActivityChanged(worker.activityName);
          logger("Succesffuly resgistered as: " + worker.friendlyName);
          logger("Currently active activity: " + worker.activityName);
        });

        worker.on("activity.update", function (worker) {
          agentActivityChanged(worker.activityName);
          logger("Worker activity changed to: " + worker.activityName);
        });

        worker.on("reservation.created", function (reservation) {
          logger("------");
          logger("You have been reserved to handle a call");
          logger("Call from: " + reservation.task.attributes.from);
          logger(
            "Selected language:" + reservation.task.attributes.selected_language
          );
          logger("------");
        });

        worker.on("reservation.accepted", function (reservation) {
          logger("Reservation " + reservation.sid + " accepted");
        });

        worker.on("reservation.rejected", function (reservation) {
          logger("Reservation " + reservation.sid + " rejected");
        });

        worker.on("reservation.timeout", function (reservation) {
          logger("Reservation " + reservation.sid + " timed out");
        });
        worker.on("reservation.canceled", function (reservation) {
          logger(`Reservation ${reservation.sid} ${canceled}`);
        });
      }
      // Hook up the agent Activity buttons to TaskRouter.js
      function bindAgentActivityButtons() {
        // Fetch the full list of available Activities from TaskRouter. Store each
        // ActivitySid against the matching Friendly Name
        var activitySids = {};
        worker.activities.fetch(function (error, activityList) {
          var activities = activityList.data;
          var i = activities.length;
          while (i--) {
            activitySids[activities[i].friendlyName] = activities[i].sid;
          }
        });

        var elements = document.getElementsByClassName("change-activity");
        var i = elements.length;
        while (i--) {
          elements[i].onclick = function () {
            var nextActivity = this.dataset.nextActivity;
            var nextActivitySid = activitySids[nextActivity];
            worker.update({ ActivitySid: nextActivitySid });
          };
        }
      }

      // Update the UI to reflect a change in Activity

      function agentActivityChanged(activity) {
        hideAgentActivities();
        showAgentActivity(activity);
      }

      function hideAgentActivities() {
        var elements = document.getElementsByClassName("agent-activity");
        var i = elements.length;
        while (i--) {
          elements[i].style.display = "none";
        }
      }

      function showAgentActivity(activity) {
        activity = activity.toLowerCase();
        var elements = document.getElementsByClassName(
          "agent-activity " + activity
        );
        elements.item(0).style.display = "block";
      }

      /* Other stuff */

      function logger(message) {
        var log = document.getElementById("log");
        log.value += "\n> " + message;
        log.scrollTop = log.scrollHeight;
      }

      window.onload = function () {
        console.log("onLoad");
        // Initialize TaskRouter.js on page load using window.workerToken -
        // a Twilio Capability token that was set from rendering the template with agents endpoint
        logger("Initializing...");
        window.worker = new Twilio.TaskRouter.Worker(
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJBQzJjYzU5YTU3OTU0NzcyOTRkMzBiZTViNDJlMWI1OTMxIiwiZXhwIjoxNjM3Nzk3NjQyLCJ2ZXJzaW9uIjoidjEiLCJhY2NvdW50X3NpZCI6IkFDMmNjNTlhNTc5NTQ3NzI5NGQzMGJlNWI0MmUxYjU5MzEiLCJjaGFubmVsIjoiV0tkZTJjMjgxNDc1NDU1OWU2MzVlNDk0NmJhY2ZlOTg0MiIsIndvcmtzcGFjZV9zaWQiOiJXUzJhMDEwYmE2Mzg5YmVjMTg0OGE4ZWFkMzdjMDViZmFmIiwicG9saWNpZXMiOlt7InVybCI6Imh0dHBzOi8vZXZlbnQtYnJpZGdlLnR3aWxpby5jb20vdjEvd3NjaGFubmVscy9BQzJjYzU5YTU3OTU0NzcyOTRkMzBiZTViNDJlMWI1OTMxL1dLZGUyYzI4MTQ3NTQ1NTllNjM1ZTQ5NDZiYWNmZTk4NDIiLCJtZXRob2QiOiJHRVQiLCJxdWVyeV9maWx0ZXIiOnt9LCJwb3N0X2ZpbHRlciI6e30sImFsbG93Ijp0cnVlfSx7InVybCI6Imh0dHBzOi8vZXZlbnQtYnJpZGdlLnR3aWxpby5jb20vdjEvd3NjaGFubmVscy9BQzJjYzU5YTU3OTU0NzcyOTRkMzBiZTViNDJlMWI1OTMxL1dLZGUyYzI4MTQ3NTQ1NTllNjM1ZTQ5NDZiYWNmZTk4NDIiLCJtZXRob2QiOiJQT1NUIiwicXVlcnlfZmlsdGVyIjp7fSwicG9zdF9maWx0ZXIiOnt9LCJhbGxvdyI6dHJ1ZX0seyJ1cmwiOiJodHRwczovL3Rhc2tyb3V0ZXIudHdpbGlvLmNvbS92MS9Xb3Jrc3BhY2VzL1dTMmEwMTBiYTYzODliZWMxODQ4YThlYWQzN2MwNWJmYWYvQWN0aXZpdGllcyIsIm1ldGhvZCI6IkdFVCIsInF1ZXJ5X2ZpbHRlciI6e30sInBvc3RfZmlsdGVyIjp7fSwiYWxsb3ciOnRydWV9LHsidXJsIjoiaHR0cHM6Ly90YXNrcm91dGVyLnR3aWxpby5jb20vdjEvV29ya3NwYWNlcy9XUzJhMDEwYmE2Mzg5YmVjMTg0OGE4ZWFkMzdjMDViZmFmL1Rhc2tzLyoqIiwibWV0aG9kIjoiR0VUIiwicXVlcnlfZmlsdGVyIjp7fSwicG9zdF9maWx0ZXIiOnt9LCJhbGxvdyI6dHJ1ZX0seyJ1cmwiOiJodHRwczovL3Rhc2tyb3V0ZXIudHdpbGlvLmNvbS92MS9Xb3Jrc3BhY2VzL1dTMmEwMTBiYTYzODliZWMxODQ4YThlYWQzN2MwNWJmYWYvV29ya2Vycy9XS2RlMmMyODE0NzU0NTU5ZTYzNWU0OTQ2YmFjZmU5ODQyL1Jlc2VydmF0aW9ucy8qKiIsIm1ldGhvZCI6IkdFVCIsInF1ZXJ5X2ZpbHRlciI6e30sInBvc3RfZmlsdGVyIjp7fSwiYWxsb3ciOnRydWV9LHsidXJsIjoiaHR0cHM6Ly90YXNrcm91dGVyLnR3aWxpby5jb20vdjEvV29ya3NwYWNlcy9XUzJhMDEwYmE2Mzg5YmVjMTg0OGE4ZWFkMzdjMDViZmFmL1dvcmtlcnMvV0tkZTJjMjgxNDc1NDU1OWU2MzVlNDk0NmJhY2ZlOTg0MiIsIm1ldGhvZCI6IkdFVCIsInF1ZXJ5X2ZpbHRlciI6e30sInBvc3RfZmlsdGVyIjp7fSwiYWxsb3ciOnRydWV9LHsidXJsIjoiaHR0cHM6Ly90YXNrcm91dGVyLnR3aWxpby5jb20vdjEvV29ya3NwYWNlcy9XUzJhMDEwYmE2Mzg5YmVjMTg0OGE4ZWFkMzdjMDViZmFmIiwibWV0aG9kIjoiR0VUIiwicXVlcnlfZmlsdGVyIjp7fSwicG9zdF9maWx0ZXIiOnt9LCJhbGxvdyI6dHJ1ZX0seyJ1cmwiOiJodHRwczovL3Rhc2tyb3V0ZXIudHdpbGlvLmNvbS92MS9Xb3Jrc3BhY2VzL1dTMmEwMTBiYTYzODliZWMxODQ4YThlYWQzN2MwNWJmYWYvKioiLCJtZXRob2QiOiJHRVQiLCJxdWVyeV9maWx0ZXIiOnt9LCJwb3N0X2ZpbHRlciI6e30sImFsbG93Ijp0cnVlfSx7InVybCI6Imh0dHBzOi8vdGFza3JvdXRlci50d2lsaW8uY29tL3YxL1dvcmtzcGFjZXMvV1MyYTAxMGJhNjM4OWJlYzE4NDhhOGVhZDM3YzA1YmZhZi8qKiIsIm1ldGhvZCI6IlBPU1QiLCJxdWVyeV9maWx0ZXIiOnt9LCJwb3N0X2ZpbHRlciI6e30sImFsbG93Ijp0cnVlfSx7InVybCI6Imh0dHBzOi8vdGFza3JvdXRlci50d2lsaW8uY29tL3YxL1dvcmtzcGFjZXMvV1MyYTAxMGJhNjM4OWJlYzE4NDhhOGVhZDM3YzA1YmZhZi8qKiIsIm1ldGhvZCI6IkRFTEVURSIsInF1ZXJ5X2ZpbHRlciI6e30sInBvc3RfZmlsdGVyIjp7fSwiYWxsb3ciOnRydWV9XSwid29ya2VyX3NpZCI6IldLZGUyYzI4MTQ3NTQ1NTllNjM1ZTQ5NDZiYWNmZTk4NDIiLCJpYXQiOjE2Mzc3OTQwNDJ9.Mksz0JYZ8SJmWG9JC5juKLr0k4sxNG6bum5B5N-XURI"
        );

        registerTaskRouterCallbacks();
        bindAgentActivityButtons();
      };
    </script>
  </head>
  <body>
    <div class="content">
      <section class="agent-activity offline">
        <p class="activity"><span>Offline</span></p>
        <button class="change-activity" data-next-activity="Idle">
          <Go>Available</Go>
        </button>
      </section>
      <section class="agent-activity idle">
        <p class="activity"><span>Available</span></p>
        <button class="change-activity" data-next-activity="Offline">
          <Go>Offline</Go>
        </button>
      </section>
      <section class="agent-activity reserved">
        <p class="activity"><Reserved></Reserved></p>
      </section>
      <section class="agent-activity busy">
        <p class="activity"><Busy></Busy></p>
      </section>
      <section class="agent-activity wrapup">
        <p class="activity">
          <Wrap-Up></Wrap-Up
          ><button class="change-activity" data-next-activity="Idle">
            <Go>Available</Go></button
          ><button class="change-activity" data-next-activity="Offline">
            <Go>Offline</Go>
          </button>
        </p>
      </section>
      <section class="log">
        <textarea id="log" readonly="true"></textarea>
      </section>
    </div>
  </body>
</html>
